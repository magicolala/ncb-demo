<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Démo NeoChessBoard.js</title>

    <!-- Pour la validation complète des règles d'échecs (optionnel, NeoChessBoard a un fallback) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chess.js/0.13.4/chess.min.js"></script>

    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            display: flex;
            flex-wrap: wrap;
            gap: 2rem;
            padding: 1rem;
            background-color: #f4f4f5;
            color: #18181b;
        }
        .board-container {
            flex-grow: 1;
            min-width: 300px;
            max-width: 640px;
        }
        .controls {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            min-width: 300px;
            flex-basis: 320px;
        }
        .control-group {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            padding: 1rem;
            background-color: #fff;
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }
        h3 {
            margin: 0 0 0.5rem 0;
            font-size: 1.1rem;
        }
        button, select, input[type="text"] {
            padding: 0.5rem 0.75rem;
            border-radius: 6px;
            border: 1px solid #d4d4d8;
            background-color: #fff;
            font-size: 1rem;
        }
        button {
            cursor: pointer;
            background-color: #fafafa;
        }
        button:hover {
            background-color: #f4f4f5;
        }
        #current-fen {
            width: 100%;
            box-sizing: border-box;
            font-family: monospace;
            font-size: 0.9rem;
            background-color: #f4f4f5;
        }
        #log-output {
            height: 120px;
            overflow-y: scroll;
            background: #f4f4f5;
            padding: 0.5rem;
            border-radius: 6px;
            font-family: monospace;
            font-size: 0.85rem;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>

    <div class="board-container">
        <div id="board"></div>
    </div>

    <div class="controls">
        <div class="control-group">
            <h3>Thème</h3>
            <select id="theme-selector">
                <option value="midnight" selected>Midnight</option>
                <option value="classic">Classic</option>
            </select>
        </div>

        <div class="control-group">
            <h3>Échiquier</h3>
            <button id="flip-board">Retourner l'échiquier</button>
            <button id="reset-board">Position initiale</button>
        </div>

        <div class="control-group">
            <h3>Position (FEN)</h3>
            <input type="text" id="fen-input" placeholder="Entrez une chaîne FEN...">
            <button id="set-fen">Charger FEN</button>
            <p style="margin: 0.5rem 0 0.25rem 0;">FEN Actuel :</p>
            <input type="text" id="current-fen" readonly>
        </div>
        
        <div class="control-group">
            <h3>Superpositions (Overlays)</h3>
            <button id="add-arrow">Ajouter une flèche (e2-e4)</button>
            <button id="clear-arrows">Effacer les flèches</button>
            <button id="highlight-squares">Surligner des cases</button>
            <button id="clear-highlights">Effacer le surlignage</button>
        </div>

        <div class="control-group">
            <h3>Journal d'événements</h3>
            <div id="log-output"></div>
        </div>
    </div>

    <script type="module">
        import { Chessboard } from './NeoChessBoard.js';

        const board = new Chessboard('#board', { theme: 'midnight' });
        const logOutput = document.getElementById('log-output');
        const currentFenInput = document.getElementById('current-fen');

        const log = (message) => logOutput.innerHTML = `${message}<br>${logOutput.innerHTML}`;
        const updateFen = () => currentFenInput.value = board.getPosition();

        board.on('move', e => { log(`Coup : ${e.from}-${e.to}`); updateFen(); });
        board.on('illegal', e => log(`Coup illégal : ${e.from}-${e.to} (${e.reason})`));
        board.on('update', () => updateFen());

        document.getElementById('theme-selector').addEventListener('change', (e) => board.setTheme(e.target.value));
        document.getElementById('flip-board').addEventListener('click', () => board.flip());
        document.getElementById('reset-board').addEventListener('click', () => board.setPosition(Chessboard.FEN.start));
        document.getElementById('set-fen').addEventListener('click', () => board.setPosition(document.getElementById('fen-input').value));
        document.getElementById('add-arrow').addEventListener('click', () => board.addArrow('e2', 'e4'));
        document.getElementById('clear-arrows').addEventListener('click', () => board.clearArrows());
        document.getElementById('highlight-squares').addEventListener('click', () => board.highlightSquares(['c4', 'c5', 'd4', 'd5']));
        document.getElementById('clear-highlights').addEventListener('click', () => board.clearHighlights());

        updateFen();
        log("Échiquier initialisé.");
    </script>
</body>
</html>